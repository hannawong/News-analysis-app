##### API 文档

------

1. **GET**    /news/index0    查询50条实时微博热搜

   **Parameters：**no parameters

   **Responses：**

   | code | description                                                  |
   | ---- | ------------------------------------------------------------ |
   | 200  | 返回新闻列表:                                                                                                                                      [        {                                                                                                                                                                     'id':1,                                                                                                                                        'title':"青岛核酸检测已采样307万份",                                                                                                                                              'hot':1113715                                                                                                                               },....  ] |
   | 400  | 参数异常                                                     |

2. **GET**      /news/wordcloud/\<cluster_id\>/\<topk\>  返回对应簇的topk词语词频

   **Parameters：**cluster_id: 新闻簇的编号，[0,20)的整数；

   ​                           topk：返回前k个频率最高的词的词频，可根据前端展示美观程度进行调整。

   **Responses：**

   | code | description                                                  |
   | ---- | ------------------------------------------------------------ |
   | 200  | 返回词频字典:                                                                                                                                      {"回购": 148, "亿元": 67, "公司": 63, "股份": 54, "格力电器": 52 ...} |
   | 400  | 参数异常                                                     |

3. **GET**      /news/search/ 新闻搜索

   **Parameters：**

   | 参数名      | 类型   | 是否必须       | 描述                     |
   | :---------- | ------ | -------------- | ------------------------ |
   | q           | 字符串 | 否，默认为“a”  | 查询的关键字             |
   | from        | 字符串 | 否，默认到最初 | 查询的起始日期（开区间） |
   | to          | 字符串 | 否，默认到最后 | 查询的终止日期（闭区间） |
   | start_index | 整型   | 否，默认0      | 查询的起始编号           |

   **Responses example：**

   | code | description                                                  |
   | ---- | ------------------------------------------------------------ |
   | 200  | `response["data"]["total"]["value"]`为搜索结果的总数；`response["data"]["hits"]`为搜索结果的列表，列表内为以start_index为起始的10条新闻。 |
   | 400  | 参数异常                                                     |

   http://127.0.0.1:8000/news/search/?q=a&from=2020-10-15&start_index=1

   ```json
   {
       "code": 200,
       "data": {
           "total": {
               "value": 8,
               "relation": "eq"
           },
           "max_score": 4.635893,
           "hits": [
               {
                   "_index": "xxswl",
                   "_type": "modelresult",
                   "_id": "news.articles.1322",
                   "_score": 3.853687,
                   "_source": {
                       "id": "news.articles.1322",
                       "django_ct": "news.articles",
                       "django_id": "1322",
                       "text": "名创优品上市首日 收盘较发行价涨4.4%\n新浪科技讯 10月16日凌晨消息，名创优品周四登陆纽交所，首日收盘报20.88美元，较发行价上涨4.4%。10月8日，相关文件显示，由腾讯控股支持的零售商名创优品（Miniso Group Holding Ltd）希望在美国进行的首次公开募股（IPO）中筹资至多5.624亿美元。名创优品表示，计划在美国的IPO发行3040万美国存托股份（ADS），预计价格为16.5-18.5美元/ADS。每份美国存托股份将代表4股A类普通股。按IPO发行价区间的最高端，名创优品的估值将达到57亿美元。9月24日，名创优品正式向美国证券交易委员会递交招股书，股票代码为“MNSO”，计划在纽交所上市。文件显示，与腾讯有关联的实体在发行股票后将拥有名创优品4.8%的股份。高盛和美国银行证券是此次发行的承销商。\nsina_mobile\n创优,品,发行价,名,首日,存托,纽交所,涨名,美国,文件,多亿美元,股类,端名,腾讯,筹资,每份,股份,上市,普通股,日名\n",
                       "title": "名创优品上市首日 收盘较发行价涨4.4%",
                       "author": "sina_mobile",
                       "body": "新浪科技讯 10月16日凌晨消息，名创优品周四登陆纽交所，首日收盘报20.88美元，较发行价上涨4.4%。10月8日，相关文件显示，由腾讯控股支持的零售商名创优品（Miniso Group Holding Ltd）希望在美国进行的首次公开募股（IPO）中筹资至多5.624亿美元。名创优品表示，计划在美国的IPO发行3040万美国存托股份（ADS），预计价格为16.5-18.5美元/ADS。每份美国存托股份将代表4股A类普通股。按IPO发行价区间的最高端，名创优品的估值将达到57亿美元。9月24日，名创优品正式向美国证券交易委员会递交招股书，股票代码为“MNSO”，计划在纽交所上市。文件显示，与腾讯有关联的实体在发行股票后将拥有名创优品4.8%的股份。高盛和美国银行证券是此次发行的承销商。",
                       "url": "https://tech.sina.cn/it/2020-10-16/detail-iiznctkc5804589.d.html",
                       "time": "2020-10-16T04:28:23",
                       "keywords": "创优,品,发行价,名,首日,存托,纽交所,涨名,美国,文件,多亿美元,股类,端名,腾讯,筹资,每份,股份,上市,普通股,日名",
                       "cluster_id": 19,
                       "emotion": 0.9242208121794773
                   }
               },
           …………………………………………（共返回十条）
           ]
       }
   }
   ```

   

4. **GET**      /news/search_heatmap/ 新闻搜索+热力图

   **Parameters：**

   | 参数名 | 类型   | 是否必须 | 描述                     |
   | :----- | ------ | -------- | ------------------------ |
   | q      | 字符串 | 否       | 查询的关键字             |
   | from   | 字符串 | 否       | 查询的起始日期（开区间） |
   | to     | 字符串 | 否       | 查询的终止日期（闭区间） |

   **Response example：**

   | code | description                                                  |
   | ---- | ------------------------------------------------------------ |
   | 200  | `response["data"]["search_res"]`和`response["data"]["heatmap"]`分别为针对查询内容的新闻搜索结果和对应的热力图 |
   | 400  | 参数异常                                                     |

   http://127.0.0.1:8000/news/search_heatmap/?q=a&from=2020-10-13

   ```json
   {
       "code": 200,
       "data": {
           "search_res": [
               {
                   "_index": "xxswl",
                   "_type": "modelresult",
                   "_id": "news.articles.362",
                   "_score": 0.96147084,
                   "_source": {
                       "id": "news.articles.362",
                       "django_ct": "news.articles",
                       "django_id": "362",
                       "text": "暴风还值得救吗？\n欢迎关注“创事记”的微信订阅号：sinachuangshiji　文/森语谢东霞编辑/子夜沉寂已久的暴风，又有了新动静。&amp;nbsp;10月9日，不少网友发现，暴风影音官网上的Windows版客户端完成了一……………………自己：“暴风值得救吗？”\nsina_mobile\n暴风,风行,影音,冯鑫,播放器,电视,体育,视频,图源,拯救,会员,在线,代,驰,集团,互联网,兆,广告,救,蔡文胜\n",
                       "title": "暴风还值得救吗？",
                       "author": "sina_mobile",
                       "body": "欢迎关注“创事记”的微信订阅号：sinachuangshiji　文/森语谢东霞编辑/子夜沉寂已久的暴风，又有了新动静。&nbsp;10月9日，不少网友发现，暴风影音官网上的Windows版客户端完成了一次更新，并上线了0.99元的“全新VIP会员”。有人收到了暴风影音弹窗升级的提示，而暴风影音右边盒子界面显示“下载新版0.99元开通月会员”的横幅广告。更新后的暴风影音变得更加简洁，没有了频道内容和官方商城，只有播放器下载提示以及会员广告。暴风影音更新展示，截图自暴风影音官网其实这次上线白菜价会员服务，并非暴风影音的突然“诈尸”。9月21日，暴…………………………",
                       "url": "http://tech.sina.cn/csj/2020-10-13/doc-iiznezxr5776210.d.html",
                       "time": "2020-10-13T20:08:41",
                       "keywords": "暴风,风行,影音,冯鑫,播放器,电视,体育,视频,图源,拯救,会员,在线,代,驰,集团,互联网,兆,广告,救,蔡文胜",
                       "cluster_id": 2,
                       "emotion": 1.0
                   }
               },
               ………………
           ],
           "heatmap": [
               {
                   "lng": 116.39564503787867,
                   "lat": 39.92998577808024,
                   "count": 74
               },
               {
                   "lng": 120.38442818368189,
                   "lat": 36.10521490127382,
                   "count": 52
               },
               {
                   "lng": 104.171240903737,
                   "lat": 36.54668170616305,
                   "count": 5
               },
               ………………
           ]
       }
   }
   ```